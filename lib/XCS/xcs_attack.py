import datetime

class XCSAttack():
	
	def __init__(self, user, ip, hostname, num_files):
		self.datetime 					= datetime.datetime.now()
		self.user 						= user
		self.ip 						= ip
		self.hostname 					= hostname
		self.num_files 					= num_files
		self._last_notification_time 	= datetime.datetime.min

	def update_num_files(self, num_files):
		print("updated number of files to " + str(num_files) + " for attack " + str(self))
		self.num_files = num_files

	def seconds_since_last_notification(self):
		return (datetime.datetime.now() - self._last_notification_time).total_seconds()

	def reset_last_notification_time(self):
		self._last_notification_time = datetime.datetime.now()

	def __str__(self):
		return "[XCSAttack datetime=%s from user=%s ip=%s hostname=%s" % (self.datetime.strftime('%d-%m-%y %H:%M:%S'), self.user, self.ip, self.hostname)
